package com.garfield.baselib.utils.http.image;

import android.app.Activity;
import android.content.Context;
import android.support.v4.app.Fragment;
import android.text.TextUtils;
import android.widget.ImageView;

import com.garfield.baselib.R;
import com.nostra13.universalimageloader.core.download.ImageDownloader;

import java.util.ArrayList;
import java.util.List;

/**
 * Created by gaowei3 on 2017/1/17.
 */

public class ImageHelper {

    public static void load(Context context, String url, ImageView imageView) {
        load(context, url, imageView, R.drawable.image_default);
    }

    public static void load(Context context, String url, ImageView imageView, int imageRes) {
        // 这里要用Application的，否则会覆盖一个空白SupportRequestManagerFragment，导致很多问题
        GlideHelper.load(context.getApplicationContext(), url, imageView, imageRes);
    }


    /**
     * 判断图片地址是否合法，合法地址如下：
     * String uri = "http://site.com/image.png"; // from Web
     * String uri = "file:///mnt/sdcard/image.png"; // from SD card
     * String uri = "content://media/external/audio/albumart/13"; // from content provider
     * String uri = "assets://image.png"; // from assets
     * String uri = "drawable://" + R.drawable.image; // from drawables (only images, non-9patch)
     */
    private static List<String> uriSchemes;
    public static boolean isImageUriValid(String uri) {
        if (TextUtils.isEmpty(uri)) {
            return false;
        }

        if (uriSchemes == null) {
            uriSchemes = new ArrayList<>();
            for (ImageDownloader.Scheme scheme : ImageDownloader.Scheme.values()) {
                uriSchemes.add(scheme.name().toLowerCase());
            }
        }

        for (String scheme : uriSchemes) {
            if (uri.toLowerCase().startsWith(scheme)) {
                return true;
            }
        }

        return false;
    }
}
